/**
 * jQuery Grid-A-Licious(tm) v3.02
 *
 * Terms of Use - jQuery Grid-A-Licious(tm)
 * under the MIT (http://www.opensource.org/licenses/mit-license.php) License.
 *
 * Copyright 2008-2013. All rights reserved. 
 * Author: Andreas Pihlstr√∂m (Suprb)
 * (http://suprb.com/apps/gridalicious/)
 * 
 * Contributors:
 *  * John Hann Debouncing function
 *              http://unscriptable.com/index.php/2009/03/20/debouncing-javascript-methods/
 *              Code from http://paulirish.com/2009/throttled-smartresize-jquery-event-handler/
 *  * github.com/falconwhite Less than one columns fix
 *  * github.com/pandaiolo Resize event fix for iOS and jQuery Mobile
 */
(function(e,t){var n=function(e,t,n){var r;return function(){function u(){if(!n)e.apply(s,o);r=null}var s=this,o=arguments;if(r){clearTimeout(r)}else if(n){e.apply(s,o)}r=setTimeout(u,t||150)}};jQuery.fn[t]=function(e){return e?this.bind("resize",n(e)):this.trigger(t)}})(jQuery,"smartresize");(function(e){e.Gal=function(t,n){this.element=e(n);this._init(t)};e.Gal.settings={selector:".item",width:225,gutter:20,animate:false,animationOptions:{speed:200,duration:300,effect:"fadeInOnAppear",queue:true,complete:function(){}}};e.Gal.prototype={_init:function(t){var n=this;this.name=this._setName(5);this.gridArr=[];this.gridArrAppend=[];this.gridArrPrepend=[];this.setArr=false;this.setGrid=false;this.setOptions;this.cols=0;this.itemCount=0;this.prependCount=0;this.isPrepending=false;this.appendCount=0;this.resetCount=true;this.ifCallback=true;this.box=this.element;this.options=e.extend(true,{},e.Gal.settings,t);this.gridArr=e.makeArray(this.box.find(this.options.selector));this.isResizing=false;this.w=0;this.previous_width=this.box.width();this.boxArr=[];this._setCols();this._renderGrid("append");e(this.box).addClass("gridalicious");e(window).smartresize(function(){n.resize()})},_setName:function(e,t){t=t?t:"";return e?this._setName(--e,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".charAt(Math.floor(Math.random()*60))+t):t},_setCols:function(){var t=0;var n=this.box.css("display");this.box.css("display","block");t=this.box.width();this.box.css("display",n);this.cols=Math.max(Math.floor(t/this.options.width),1);diff=(t-this.cols*this.options.width-this.options.gutter)/this.cols;w=(this.options.width+diff)/t*100;this.w=w;for(var r=0;r<this.cols;r++){var i=e("<div></div>").addClass("galcolumn").attr("id","item"+r+this.name).css({width:w+"%",paddingLeft:this.options.gutter,paddingBottom:this.options.gutter,"float":"left","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","-o-box-sizing":"border-box","box-sizing":"border-box"});this.box.append(i)}this.box.find(e("#clear"+this.name)).remove();var s=e("<div></div>").css({clear:"both",height:"0",width:"0",display:"block"}).attr("id","clear"+this.name);this.box.append(s)},_renderGrid:function(t,n,r,i){var s=[];var o=[];var u=[];var a=0;var f=this.prependCount;var l=this.appendCount;var c=this.options.gutter;var h=this.cols;var p=this.name;var d=0;var v=e(".galcolumn").width();if(n){o=n;if(t=="append"){l+=r;a=this.appendCount}if(t=="prepend"){this.isPrepending=true;a=Math.round(r%h);if(a<=0)a=h}if(t=="renderAfterPrepend"){l+=r;a=r}}else{o=this.gridArr;l=e(this.gridArr).size()}e.each(o,function(n,r){var i=e(r);var o="100%";if(i.hasClass("not-responsive")){o="auto"}i.css({marginBottom:c,zoom:"1",filter:"alpha(opacity=0)",opacity:"0"}).find("img, object, embed, iframe").css({width:o,height:"auto",display:"block","margin-left":"auto","margin-right":"auto"});if(t=="prepend"){a--;e("#item"+a+p).prepend(i);s.push(i);if(a===0)a=h}else{e("#item"+a+p).append(i);s.push(i);a++;if(a>=h)a=0;if(l>=h)l=l-h}});this.appendCount=l;this.itemCount=a;if(t=="append"||t=="prepend"){if(t=="prepend"){this._updateAfterPrepend(this.gridArr,o)}this._renderItem(s);this.isPrepending=false}else{this._renderItem(this.gridArr)}},_collectItems:function(){var t=[];e(this.box).find(this.options.selector).each(function(n){t.push(e(this))});return t},_renderItem:function(t){var n=this.options.animationOptions.speed;var r=this.options.animationOptions.effect;var i=this.options.animationOptions.duration;var s=this.options.animationOptions.queue;var o=this.options.animate;var u=this.options.animationOptions.complete;var a=0;var f=0;if(o===true&&!this.isResizing){if(s===true&&r=="fadeInOnAppear"){if(this.isPrepending)t.reverse();e.each(t,function(r,s){setTimeout(function(){e(s).animate({opacity:"1.0"},i);f++;if(f==t.length){u.call(undefined,t)}},a*n);a++})}else if(s===false&&r=="fadeInOnAppear"){if(this.isPrepending)t.reverse();e.each(t,function(n,r){e(r).animate({opacity:"1.0"},i);f++;if(f==t.length){if(this.ifCallback){u.call(undefined,t)}}})}if(s===true&&!r){e.each(t,function(n,r){e(r).css({opacity:"1",filter:"alpha(opacity=1)"});f++;if(f==t.length){if(this.ifCallback){u.call(undefined,t)}}})}}else{e.each(t,function(t,n){e(n).css({opacity:"1",filter:"alpha(opacity=1)"})});if(this.ifCallback){u.call(t)}}},_updateAfterPrepend:function(t,n){var r=this.gridArr;e.each(n,function(e,t){r.unshift(t)});this.gridArr=r},resize:function(){if(this.box.width()==this.previous_width){return}this.previous_width=this.box.width();this.box.find(e(".galcolumn")).remove();this._setCols();this.ifCallback=false;this.isResizing=true;this._renderGrid("append");this.ifCallback=true;this.isResizing=false},append:function(t){var n=this.gridArr;var r=this.gridArrPrepend;e.each(t,function(e,t){n.push(t);r.push(t)});this._renderGrid("append",t,e(t).size())},prepend:function(t){this.ifCallback=false;this._renderGrid("prepend",t,e(t).size());this.ifCallback=true}};e.fn.gridalicious=function(t,n){if(typeof t==="string"){this.each(function(){var r=e.data(this,"gridalicious");r[t].apply(r,[n])})}else{this.each(function(){e.data(this,"gridalicious",new e.Gal(t,this))})}return this}})(jQuery)